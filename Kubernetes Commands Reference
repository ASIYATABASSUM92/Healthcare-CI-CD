# Kubernetes Commands Reference

## üìã DEPLOYMENT MANAGEMENT

### View Resources
```bash
# List all resources
kubectl get all

# List deployments
kubectl get deployments
kubectl get deploy

# List pods
kubectl get pods
kubectl get po

# List services
kubectl get services
kubectl get svc

# Detailed information
kubectl describe deployment healthcare-deployment
kubectl describe pod <pod-name>
kubectl describe service healthcare-service
```

### Create/Update/Delete
```bash
# Apply configuration
kubectl apply -f deployment.yaml

# Delete resources
kubectl delete -f deployment.yaml
kubectl delete deployment healthcare-deployment
kubectl delete pod <pod-name>

# Scale deployment
kubectl scale deployment healthcare-deployment --replicas=5

# Update image (rolling update)
kubectl set image deployment/healthcare-deployment healthcare-app=healthcare-app:2.0.0
```

## üîç DEBUGGING

### Logs
```bash
# View logs
kubectl logs <pod-name>
kubectl logs -f <pod-name>  # Follow logs
kubectl logs <pod-name> --previous  # Previous container logs

# Logs from all pods with label
kubectl logs -l app=healthcare
```

### Execute Commands in Pod
```bash
# Open shell in pod
kubectl exec -it <pod-name> -- /bin/bash

# Run single command
kubectl exec <pod-name> -- ls /usr/local/tomcat/webapps
kubectl exec <pod-name> -- curl localhost:8080
```

### Port Forwarding (Access pod directly)
```bash
# Forward local port to pod
kubectl port-forward <pod-name> 8080:8080

# Forward to service
kubectl port-forward service/healthcare-service 8080:8080

# Now access: http://localhost:8080
```

## üè• HEALTH CHECKS

### Check Pod Status
```bash
# Get pod status
kubectl get pods

# Watch pod status (real-time)
kubectl get pods -w

# Get events (troubleshooting)
kubectl get events --sort-by=.metadata.creationTimestamp

# Check pod resource usage
kubectl top pods
```

### Restart Pods
```bash
# Delete pod (it will auto-recreate)
kubectl delete pod <pod-name>

# Restart deployment (rollout restart)
kubectl rollout restart deployment healthcare-deployment

# Check rollout status
kubectl rollout status deployment healthcare-deployment

# Rollout history
kubectl rollout history deployment healthcare-deployment

# Rollback to previous version
kubectl rollout undo deployment healthcare-deployment
```

## üåê NETWORKING

### Services
```bash
# Get service details
kubectl get service healthcare-service

# Get service endpoints
kubectl get endpoints healthcare-service

# Test service from inside cluster
kubectl run test --image=busybox -it --rm -- wget -qO- healthcare-service:8080
```

## üìä MONITORING

### Resource Usage
```bash
# Node resources
kubectl top nodes

# Pod resources
kubectl top pods

# Specific pod
kubectl top pod <pod-name>
```

### Cluster Info
```bash
# Cluster information
kubectl cluster-info

# Node status
kubectl get nodes

# Component status
kubectl get componentstatuses
```

## üîê SECRETS & CONFIGS

### ConfigMaps
```bash
# Create configmap from file
kubectl create configmap app-config --from-file=config.properties

# Create from literal values
kubectl create configmap app-config --from-literal=key1=value1

# View configmap
kubectl get configmap app-config -o yaml
```

### Secrets
```bash
# Create secret
kubectl create secret generic db-secret --from-literal=password=admin123

# View secret (base64 encoded)
kubectl get secret db-secret -o yaml

# Use in deployment (see deployment.yaml examples)
```

## üöÄ ADVANCED

### Labels & Selectors
```bash
# Show labels
kubectl get pods --show-labels

# Filter by label
kubectl get pods -l app=healthcare
kubectl get pods -l version=v1.0.0

# Add label to pod
kubectl label pod <pod-name> environment=production
```

### Namespace Management
```bash
# Create namespace
kubectl create namespace healthcare

# List namespaces
kubectl get namespaces

# Set default namespace
kubectl config set-context --current --namespace=healthcare

# View resources in namespace
kubectl get all -n healthcare
```

## üîÑ UPDATE STRATEGIES

### Rolling Update
```bash
# Update image
kubectl set image deployment/healthcare-deployment healthcare-app=healthcare-app:2.0.0

# Pause rollout
kubectl rollout pause deployment/healthcare-deployment

# Resume rollout
kubectl rollout resume deployment/healthcare-deployment

# Check status
kubectl rollout status deployment/healthcare-deployment
```

### Rollback
```bash
# Undo last rollout
kubectl rollout undo deployment/healthcare-deployment

# Undo to specific revision
kubectl rollout undo deployment/healthcare-deployment --to-revision=2

# View rollout history
kubectl rollout history deployment/healthcare-deployment
```

## üíæ EXPORT CONFIGURATIONS

### Save Current State
```bash
# Export deployment to YAML
kubectl get deployment healthcare-deployment -o yaml > deployment-backup.yaml

# Export all resources
kubectl get all -o yaml > all-resources-backup.yaml
```

## üßπ CLEANUP

### Delete Resources
```bash
# Delete by file
kubectl delete -f deployment.yaml

# Delete by name
kubectl delete deployment healthcare-deployment
kubectl delete service healthcare-service

# Delete all in namespace
kubectl delete all --all -n healthcare

# Delete namespace (and everything in it)
kubectl delete namespace healthcare
```

## üéØ QUICK TROUBLESHOOTING

### Pod Won't Start
```bash
# 1. Check pod status
kubectl describe pod <pod-name>

# 2. Check events
kubectl get events --field-selector involvedObject.name=<pod-name>

# 3. Check logs
kubectl logs <pod-name>

# 4. Check previous logs (if restarted)
kubectl logs <pod-name> --previous
```

### Service Not Accessible
```bash
# 1. Check service exists
kubectl get service healthcare-service

# 2. Check endpoints
kubectl get endpoints healthcare-service

# 3. Test from inside cluster
kubectl run test --image=busybox -it --rm -- wget -qO- healthcare-service:8080

# 4. Check node port
kubectl get service healthcare-service -o wide
```

### Image Pull Errors
```bash
# 1. Check image name
kubectl describe pod <pod-name> | grep -i image

# 2. Check imagePullPolicy
kubectl get pod <pod-name> -o yaml | grep imagePullPolicy

# 3. Check image exists locally
docker images | grep healthcare
```
